<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      /* Keep all existing styles */
      body {
        background-color: #1a1a1a;
        margin: 0;
        padding: 20px;
        font-family: Arial, sans-serif;
        overflow-x: hidden;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        color: white;
        flex-wrap: wrap;
        gap: 10px;
      }

      .quantity-display {
        position: absolute;
        top: 5px;
        right: 5px;
        background: gold; /* Change this to your preferred color */
        color: black; /* Change this to your preferred text color */
        font-size: 14px; /* Adjust font size as needed */
        padding: 2px 5px; /* Add padding for a nicer look */
        border-radius: 4px; /* Rounded corners */
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 25px; /* Minimum width to fit one digit */
        max-width: 40px; /* Maximum width to fit three digits */
        text-align: center; /* Center text */
        font-weight: bold;
      }

      .search-box {
        padding: 8px;
        border-radius: 4px;
        border: 1px solid #4a4a4a;
        background: #2a2a2a;
        color: white;
        width: 200px;
      }

      .cart-icon {
        position: relative;
        cursor: pointer;
        padding: 8px;
        background: #2a2a2a;
        border-radius: 4px;
      }

      .cart-count {
        position: absolute;
        top: -8px;
        right: -8px;
        background: red;
        color: white;
        border-radius: 50%;
        padding: 2px 6px;
        font-size: 12px;
      }

      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        z-index: 1000;
      }

      .modal-content {
        background: #2a2a2a;
        margin: 5% auto;
        width: 80%;
        max-width: 600px;
        border-radius: 8px;
        color: white;
        display: flex;
        flex-direction: column;
        max-height: 90vh;
      }

      .modal-header {
        padding: 20px 20px 10px 20px;
        border-bottom: 1px solid #4a4a4a;
      }

      .modal-body {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
        max-height: none;
      }

      .close {
        float: right;
        cursor: pointer;
        font-size: 24px;
      }

      .cart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 0;
        border-bottom: 1px solid #4a4a4a;
      }

      .checkout-btn {
        background: #4caf50;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        margin-top: 20px;
      }

      .scroll-container {
        width: 100%;
        overflow-x: auto;
        padding-bottom: 12px;
      }

      /* Updated grid container for responsiveness */
      .grid-container {
        display: flex;
        flex-wrap: wrap;
        gap: 4px;
        padding: 4px;
        justify-content: flex-start;
      }

      .item-card {
        background-color: #2a2a2a;
        border-radius: 4px;
        overflow: hidden;
        position: relative;
        cursor: pointer;
        width: 130px; /* Fixed width as per original design */
        flex: 0 0 130px; /* Prevent growing or shrinking */
        margin-bottom: 4px;
      }

      .item-image {
        width: 100%;
        height: 80px;
        background-color: #333;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative; /* Added for gem positioning */
      }

      .item-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      /* New gem display styles */
      .gem-display {
        position: absolute;
        top: 2px;
        right: 2px;
        width: 30px;
        height: 30px;
        background: rgba(0, 0, 0, 0.7);
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10;
      }

      .gem-display img {
        width: 30px;
        height: 30px;
        border-radius: 4px;
        /*object-fit: contain;*/
      }

      .item-info {
        padding: 6px;
        text-align: center;
      }

      .item-name {
        color: #fff;
        font-size: 13px;
        margin: 0 0 2px 0;
        line-height: 1.2;
        height: 2.4em;
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        text-align: center;
      }

      .item-price {
        background-color: #000;
        border: 1px solid #fff;
        color: #fff;
        font-size: 16px;
        margin: 4px auto;
        padding: 2px 8px;
        border-radius: 4px;
        display: inline-flex;
        align-items: center;
        gap: 2px;
      }

      .item-price::before {
        content: "P";
        font-size: 14px;
      }

      .scroll-container::-webkit-scrollbar {
        height: 8px;
      }

      .scroll-container::-webkit-scrollbar-track {
        background: #1a1a1a;
        border-radius: 4px;
      }

      .scroll-container::-webkit-scrollbar-thumb {
        background: #4a4a4a;
        border-radius: 4px;
      }

      .scroll-container::-webkit-scrollbar-thumb:hover {
        background: #555;
      }

      /* Cart item image */
      .cart-item-image {
        width: 40px;
        height: 40px;
        object-fit: cover;
        border-radius: 4px;
        margin-right: 10px;
      }

      /* Adjust cart item layout */
      .cart-item {
        display: flex;
        align-items: center;
        padding: 10px 0;
        border-bottom: 1px solid #4a4a4a;
      }

      .cart-item-details {
        flex-grow: 1;
        margin-right: 10px;
      }

      /* Scrollbar styling for modal body */
      .modal-body::-webkit-scrollbar {
        width: 8px;
      }

      .modal-body::-webkit-scrollbar-track {
        background: #1a1a1a;
        border-radius: 4px;
      }

      .modal-body::-webkit-scrollbar-thumb {
        background: #4a4a4a;
        border-radius: 4px;
      }

      .modal-body::-webkit-scrollbar-thumb:hover {
        background: #555;
      }

      /* Media queries for responsive header */
      @media (max-width: 768px) {
        .header {
          flex-direction: column;
          align-items: flex-start;
        }

        .timestamp {
          margin-bottom: 10px;
          width: 100%;
        }

        .search-box {
          width: 100%;
          box-sizing: border-box;
          margin-bottom: 10px;
        }

        .hero-filter {
          width: 100%;
          margin-left: 0;
          margin-bottom: 10px;
        }

        .hero-filter select {
          width: 100%;
          box-sizing: border-box;
        }

        .cart-icon {
          align-self: flex-end;
        }

        /* Make modal content fill more of the screen on mobile */
        .modal-content {
          width: 90%;
          margin: 5% auto;
          padding: 0;
        }

        .modal-header {
          padding: 15px 15px 10px 15px;
        }

        .modal-body {
          padding: 0 15px;
        }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <div
        class="timestamp"
        style="display: flex; align-items: center; gap: 10px"
      >
        <!--[1]-->
        

        <input
          type="text"
          id="updateTimeInput"
          class="search-box"
          style="display: none; width: 200px"
          placeholder="e.g., January, 18 2025 10:37 am"
          onblur="hideTimeInput()"
          onkeypress="handleKeyPress(event)"
        />
      </div>
      <input
        type="text"
        class="search-box"
        placeholder="Search items..."
        id="searchBox"
      />

      <div class="hero-filter" style="margin-left: 10px">
        <select id="heroFilter" class="search-box" style="cursor: pointer">
          <option value="all">All Heroes</option>
          <option value="Cosmic Heroes Hoard Treasure">Cosmic Heroes Hoard Treasure</option>
          <option value="Crownfall 2024 Collectors Cache">Crownfall 2024 Collectors Cache</option>
          <option value="Crownfall 2024 Collectors Cache II">Crownfall 2024 Collectors Cache II</option>
          <option value="Dead Reckoning Chest">Dead Reckoning Chest</option>
          <option value="Frostivus 2017 Treasure">Frostivus 2017 Treasure</option>
          <option value="Treasure of the Forgotten Myth">Treasure of the Forgotten Myth</option>
          <option value="Treasure of the Onyx Eye">Treasure of the Onyx Eye</option>
          
          Crownfall 2024 Collectors Cache
          <option value="Other">Other</option>
        </select>
      </div>

      <!-- Account Filter -->
      <select id="account-filter" class="search-box">
        <option value="all">All Accounts</option>
        <option value="Acc 1">Acc 1</option>
        <option value="Acc 2">Acc 2</option>
        <option value="other">Other / No Account</option>
      </select>

      <div class="cart-icon" onclick="toggleCart()">
        ðŸ›’ <span class="cart-count" id="cartCount">0</span>
      </div>
    </div>

    <div class="scroll-container">
      <div class="grid-container" id="itemsContainer">
        <!--[2]-->
        
        
        
      </div>
    </div>

    <!-- Shopping Cart Modal -->
    <div id="cartModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <span class="close" onclick="toggleCart()">&times;</span>
          <h2>Order Summary</h2>
        </div>
        <div class="modal-body">
          <div id="cartItems"></div>
          <div id="cartTotal"></div>
          <button class="checkout-btn" onclick="checkout()">
            Proceed to Checkout
          </button>
        </div>
      </div>
    </div>

    <script>
      // Initialize cart
      let cart = JSON.parse(localStorage.getItem("cart")) || [];

      window.onload = function () {
        updateCartDisplay(); // show existing cart when page loads
      };

      // Time input handling
      function showTimeInput() {
        const timeText = document.getElementById("updateTimeText");
        const timeInput = document.getElementById("updateTimeInput");
        timeText.style.display = "none";
        timeInput.style.display = "block";
        timeInput.value = timeText.textContent;
        timeInput.focus();
      }

      function hideTimeInput() {
        const timeText = document.getElementById("updateTimeText");
        const timeInput = document.getElementById("updateTimeInput");
        timeText.style.display = "inline";
        timeInput.style.display = "none";
        if (timeInput.value.trim()) {
          timeText.textContent = timeInput.value;
        }
      }

      function handleKeyPress(event) {
        if (event.key === "Enter") {
          hideTimeInput();
        }
      }

      // Function to add to cart with ETOP price
      function addToCart(name, price, imageUrl, account) {
        const etopPrice = getEtopPrice(name);
        cart.push({ name, price, imageUrl, etopPrice, account });
        // Save cart to localStorage
        localStorage.setItem("cart", JSON.stringify(cart));
        updateCartDisplay(); // Ensure this is called to update the UI
        alert(`Added ${name} to cart!`);
      }

      // Function to get ETOP price based on item name
      function getEtopPrice(name) {
        const etopPrices = {
          // [3]
          
          
          

        };
        return etopPrices[name] || 0;
      }

      // Updated cart display function
      function updateCartDisplay() {
        const cartCount = document.getElementById("cartCount");
        cartCount.textContent = cart.length; // Update cart count

        const cartItems = document.getElementById("cartItems");
        cartItems.innerHTML = ""; // Clear existing items

        let total = 0;
        let etopTotal = 0;

        cart.forEach((item, index) => {
          const itemDiv = document.createElement("div");
          itemDiv.className = "cart-item";
          itemDiv.innerHTML = `
            <img src="${item.imageUrl}" alt="${item.name}" class="cart-item-image">
            <div class="cart-item-details">
                <span>${item.name}</span>
                <span>P${item.price}</span>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center; gap: 10px;">
                <div style="display: flex; flex-direction: column; align-items: flex-start;">
                    <span class="account-info">(${item.account})</span> <!-- Account info on the left -->
                    <span style="font-size: 16px;">$${item.etopPrice}</span> <!-- Value below -->
                </div>
                <button onclick="removeFromCart(${index})">Remove</button> <!-- Remove button -->
            </div>
        `;
          cartItems.appendChild(itemDiv);
          total += parseFloat(item.price) || 0;
          etopTotal += parseFloat(item.etopPrice);
        });

        const ratio = etopTotal > 0 ? total / etopTotal : 0;

        document.getElementById("cartTotal").innerHTML = `
        <h3>Total: P${total}</h3>
        <h3 style="color: #4CAF50; font-size: 18px;">Total ETOP: $${etopTotal.toFixed(
          2
        )}</h3>
        <h4 style="color: #808080; margin-top: 10px;">Rate: ${ratio.toFixed(
          2
        )}</h4>
    `;
      }

      function removeFromCart(index) {
        cart.splice(index, 1);
        localStorage.setItem("cart", JSON.stringify(cart));
        updateCartDisplay();
      }

      function toggleCart() {
        const modal = document.getElementById("cartModal");
        modal.style.display =
          modal.style.display === "block" ? "none" : "block";
      }

      function checkout() {
        if (cart.length === 0) {
          alert("Your cart is empty!");
          return;
        }

        let summary = "Order Summary:\n\n";
        let total = 0;

        cart.forEach((item) => {
          summary += `${item.name}: P${item.price}\n`;
          total += parseFloat(item.price) || 0;
        });

        summary += `\nTotal: P${total}`;
        alert(summary);

        // Clear cart after checkout
        cart = [];
        localStorage.removeItem("cart");
        updateCartDisplay();
        toggleCart();
      }

      const heroItemMapping = {
        // [4]
        
        
      };

      const searchBox = document.getElementById("searchBox");
      const heroFilter = document.getElementById("heroFilter");
      const accountFilter = document.getElementById("account-filter");
      const items = document.querySelectorAll(".item-card");

      // Reusable filter function
      function applyFilters() {
        const searchTerm = searchBox.value.toLowerCase();
        const selectedHero = heroFilter.value;
        const selectedAccount = accountFilter.value;

        items.forEach((item) => {
          const itemName = item
            .querySelector(".item-name")
            .textContent.toLowerCase();
          const account = item.dataset.account || "other";

          let show = true;

          // ðŸ”Ž Search filter
          if (searchTerm && !itemName.includes(searchTerm)) {
            show = false;
          }

          // ðŸ¦¸ Hero filter
          if (selectedHero !== "all") {
            if (selectedHero === "Other") {
              let belongsToSpecificHero = false;
              for (const hero in heroItemMapping) {
                if (
                  heroItemMapping[hero].some((heroItem) =>
                    itemName.includes(heroItem.toLowerCase())
                  )
                ) {
                  belongsToSpecificHero = true;
                  break;
                }
              }
              if (belongsToSpecificHero) show = false;
            } else {
              const heroItems = heroItemMapping[selectedHero] || [];
              if (
                !heroItems.some((heroItem) =>
                  itemName.includes(heroItem.toLowerCase())
                )
              ) {
                show = false;
              }
            }
          }

          // ðŸ‘¤ Account filter
          if (selectedAccount !== "all" && account !== selectedAccount) {
            show = false;
          }

          // Final show/hide
          item.style.display = show ? "" : "none";
        });
      }

      // Attach all listeners to the same function
      searchBox.addEventListener("input", applyFilters);
      heroFilter.addEventListener("change", applyFilters);
      accountFilter.addEventListener("change", applyFilters);
    </script>
  </body>
</html>


